"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[317],{1355:(e,s,t)=>{t.d(s,{A:()=>u});var a=t(5155),l=t(2115),d=t(5781),r=t(6472),i=t(5209),o=t(1455),n=t.n(o),c=t(6745),m=t(1864),g=t(6261);d.t1.register(d.PP,d.kc,d.FN,d.No,d.E8,d.hE,d.m_,d.s$,d.dN);let x={primary:"#6366F1",success:"#34D399",warning:"#FBBF24",error:"#F87171",background:"rgba(99, 102, 241, 0.1)"},h=e=>{let{tasks:s}=e,t=s.reduce((e,s)=>e+(s.points||0),0),l=s.filter(e=>e.completed).reduce((e,s)=>e+(s.points||0),0),d=new Date,i=d.getFullYear(),o=d.getMonth(),n=d.getDate(),c=Array.from({length:7},(e,s)=>{let t=new Date(i,o,n-(6-s));return t.setHours(0,0,0,0),t}),m=s.filter(e=>e.completed);console.log("Completed tasks:",m);let g=c.map(e=>{if(e.getDate()===n&&e.getMonth()===o&&e.getFullYear()===i){let s=m.reduce((e,s)=>e+(s.points||0),0);return console.log("Today (".concat(e.toLocaleDateString(),"): Found ").concat(m.length," completed tasks, total ").concat(s," points")),s}return 0}),h=Math.max(...g,1),u={labels:c.map(e=>{let s=(e.getMonth()+1).toString().padStart(2,"0"),t=e.getDate().toString().padStart(2,"0");return"".concat(s,"/").concat(t)}),datasets:[{label:"每日获得积分",data:g,fill:!0,borderColor:x.primary,backgroundColor:x.background,tension:.4,pointBackgroundColor:x.primary,pointBorderColor:"#fff",pointBorderWidth:2,pointRadius:4,pointHoverRadius:6}]},p={easy:s.filter(e=>2>=(e.points||0)).length,medium:s.filter(e=>(e.points||0)>2&&5>=(e.points||0)).length,hard:s.filter(e=>(e.points||0)>5).length},b={labels:["简单 (≤2分)","中等 (3-5分)","困难 (>5分)"],datasets:[{label:"任务数量",data:[p.easy,p.medium,p.hard],backgroundColor:[x.success,x.warning,x.error],borderWidth:0,borderRadius:4}]};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-2xl p-6 shadow-sm",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"总积分"}),(0,a.jsxs)("div",{className:"flex items-baseline",children:[(0,a.jsx)("span",{className:"text-3xl font-bold",style:{color:x.primary},children:t}),(0,a.jsx)("span",{className:"ml-2 text-gray-500",children:"分"})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-2xl p-6 shadow-sm",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"已获得积分"}),(0,a.jsxs)("div",{className:"flex items-baseline",children:[(0,a.jsx)("span",{className:"text-3xl font-bold",style:{color:x.success},children:l}),(0,a.jsx)("span",{className:"ml-2 text-gray-500",children:"分"})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-2xl p-6 shadow-sm",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"完成率"}),(0,a.jsx)("div",{className:"flex items-baseline",children:(0,a.jsxs)("span",{className:"text-3xl font-bold",style:{color:x.primary},children:[t?Math.round(l/t*100):0,"%"]})})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-2xl p-6 shadow-sm",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-6",children:"积分获取趋势"}),(0,a.jsx)("div",{className:"h-[300px]",children:(0,a.jsx)(r.N1,{data:u,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{usePointStyle:!0,padding:20,font:{size:12}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",padding:12,titleFont:{size:14,weight:"bold"},bodyFont:{size:13},cornerRadius:4}},scales:{x:{grid:{display:!1}},y:{beginAtZero:!0,suggestedMax:h+1,grid:{color:"rgba(0, 0, 0, 0.05)"},ticks:{stepSize:1,callback:function(e){return e+"分"}}}}}})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-2xl p-6 shadow-sm",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-6",children:"任务难度分布"}),(0,a.jsx)("div",{className:"h-[300px]",children:(0,a.jsx)(r.yP,{data:b,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{usePointStyle:!0,padding:20,font:{size:12}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",padding:12,titleFont:{size:14,weight:"bold"},bodyFont:{size:13},cornerRadius:4}},scales:{x:{grid:{display:!1}},y:{beginAtZero:!0,grid:{color:"rgba(0, 0, 0, 0.05)"}}}}})})]})]})};d.t1.register(d.PP,d.kc,d.E8,d.hE,d.m_,d.s$,d.Bs,d.FN,d.No,d.dN);let u=()=>{let{tasks:e,tags:s}=(0,i.k)(),[t,d]=(0,l.useState)({}),[o,x]=(0,l.useState)({completed:0,pending:0}),[u,p]=(0,l.useState)({}),[b,f]=(0,l.useState)(0),[j,N]=(0,l.useState)("overview");(0,l.useEffect)(()=>{d(s.reduce((s,t)=>(s[t.name]=e.filter(e=>e.tag.id===t.id).length,s),{})),x(e.reduce((e,s)=>(s.completed?e.completed++:e.pending++,e),{completed:0,pending:0}));let t=Array.from({length:7},(e,s)=>n()().subtract(s,"day").format("MM-DD")).reverse().reduce((s,t)=>(s[t]=e.filter(e=>n()(e.date).format("MM-DD")===t).length,s),{});p(t);let a=Object.values(t).reduce((e,s)=>e+s,0),l=e.filter(e=>{let s=n()(e.date),t=n()().diff(s,"day");return t>=7&&t<14}).length;f(l?(a-l)/l*100:0)},[e,s]);let v={labels:Object.keys(t),datasets:[{data:Object.values(t),backgroundColor:["rgba(82, 82, 255, 0.8)","rgba(255, 82, 82, 0.8)","rgba(82, 255, 82, 0.8)","rgba(255, 255, 82, 0.8)","rgba(255, 82, 255, 0.8)","rgba(82, 255, 255, 0.8)"],borderWidth:0}]},y={labels:Object.keys(u),datasets:[{label:"每日任务数",data:Object.values(u),fill:!0,borderColor:"rgba(82, 82, 255, 0.8)",backgroundColor:"rgba(82, 82, 255, 0.1)",tension:.4,pointBackgroundColor:"rgba(82, 82, 255, 0.8)",pointBorderColor:"#fff",pointBorderWidth:2,pointRadius:4,pointHoverRadius:6}]},w={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",padding:12,titleFont:{size:14,weight:"bold"},bodyFont:{size:13},cornerRadius:8}},scales:{x:{grid:{display:!1}},y:{beginAtZero:!0,grid:{color:"rgba(0, 0, 0, 0.05)"}}}};return(0,a.jsxs)("div",{className:"p-8 bg-gray-50",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[(0,a.jsxs)("div",{className:"bg-white rounded-2xl p-6 shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("div",{className:"text-gray-500",children:"总任务"}),(0,a.jsx)("div",{className:"w-10 h-10 rounded-full bg-blue-50 flex items-center justify-center",children:(0,a.jsx)(c.A,{className:"w-5 h-5 text-[#5252FF]"})})]}),(0,a.jsx)("div",{className:"text-3xl font-bold mb-2",children:e.length}),(0,a.jsxs)("div",{className:"flex items-center text-sm",children:[(0,a.jsxs)("span",{className:"flex items-center ".concat(b>=0?"text-green-500":"text-red-500"),children:[b>=0?(0,a.jsx)(m.A,{className:"w-4 h-4 mr-1"}):(0,a.jsx)(g.A,{className:"w-4 h-4 mr-1"}),Math.abs(b).toFixed(1),"%"]}),(0,a.jsx)("span",{className:"text-gray-400 ml-2",children:"周同比"})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-2xl p-6 shadow-sm",children:[(0,a.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,a.jsx)("div",{className:"text-gray-500",children:"完成率"})}),(0,a.jsxs)("div",{className:"text-3xl font-bold mb-2",children:[e.length?(o.completed/e.length*100).toFixed(1):0,"%"]}),(0,a.jsx)("div",{className:"w-full bg-gray-100 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-[#5252FF] h-2 rounded-full transition-all duration-500",style:{width:"".concat(e.length?o.completed/e.length*100:0,"%")}})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-2xl p-6 shadow-sm md:col-span-2",children:[(0,a.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,a.jsx)("div",{className:"text-gray-500",children:"任务分布"})}),(0,a.jsx)("div",{className:"flex items-center gap-4",children:Object.entries(t).map((s,t)=>{let[l,d]=s;return(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"text-sm text-gray-500 mb-1",children:l}),(0,a.jsx)("div",{className:"text-2xl font-bold mb-2",children:d}),(0,a.jsx)("div",{className:"w-full bg-gray-100 rounded-full h-2",children:(0,a.jsx)("div",{className:"h-2 rounded-full transition-all duration-500",style:{width:"".concat(d/e.length*100,"%"),backgroundColor:v.datasets[0].backgroundColor[t]}})})]},l)})})]})]}),(0,a.jsxs)("div",{className:"flex space-x-4 mb-6",children:[(0,a.jsx)("button",{className:"px-4 py-2 rounded-lg font-medium transition-colors ".concat("overview"===j?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-100"),onClick:()=>N("overview"),children:"总览"}),(0,a.jsx)("button",{className:"px-4 py-2 rounded-lg font-medium transition-colors ".concat("points"===j?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-100"),onClick:()=>N("points"),children:"积分统计"})]}),"overview"===j?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[(0,a.jsx)("div",{className:"bg-white rounded-2xl p-6 shadow-sm",children:(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(c.A,{className:"w-8 h-8 text-blue-500"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"总任务"}),(0,a.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,a.jsx)("span",{className:"text-3xl font-bold",children:e.length}),(0,a.jsx)("span",{className:"text-sm text-gray-500",children:b>=0?(0,a.jsxs)("span",{className:"flex items-center text-green-500",children:[(0,a.jsx)(m.A,{className:"w-4 h-4"}),b,"%"]}):(0,a.jsxs)("span",{className:"flex items-center text-red-500",children:[(0,a.jsx)(g.A,{className:"w-4 h-4"}),Math.abs(b),"%"]})})]})]})]})}),(0,a.jsxs)("div",{className:"bg-white rounded-2xl p-6 shadow-sm",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"完成率"}),(0,a.jsx)("div",{className:"flex items-baseline",children:(0,a.jsxs)("span",{className:"text-3xl font-bold",children:[(o.completed/e.length*100).toFixed(1),"%"]})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-2xl p-6 shadow-sm",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"任务分布"}),(0,a.jsx)("div",{className:"flex items-center gap-4",children:(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,a.jsx)("span",{children:"开发"}),(0,a.jsx)("span",{children:t["开发"]||0})]}),(0,a.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,a.jsx)("span",{children:"会议"}),(0,a.jsx)("span",{children:t["会议"]||0})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"休息"}),(0,a.jsx)("span",{children:t["休息"]||0})]})]})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-2xl p-6 shadow-sm",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-6",children:"近7天趋势"}),(0,a.jsx)("div",{className:"h-[400px]",children:(0,a.jsx)(r.N1,{data:y,options:{...w,plugins:{...w.plugins,legend:{display:!0,position:"top",align:"end",labels:{usePointStyle:!0,padding:20,font:{size:12}}}}}})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-2xl p-6 shadow-sm",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-6",children:"标签分布"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsx)("div",{className:"md:col-span-1",children:(0,a.jsx)("div",{className:"h-[300px] flex items-center justify-center",children:(0,a.jsx)("div",{className:"w-full max-w-[300px]",children:(0,a.jsx)(r.nu,{data:v,options:{...w,cutout:"75%",plugins:{legend:{display:!1}}}})})})}),(0,a.jsx)("div",{className:"md:col-span-2 flex flex-col justify-center",children:(0,a.jsx)("div",{className:"space-y-4",children:Object.entries(t).map((s,t)=>{let[l,d]=s;return(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:v.datasets[0].backgroundColor[t]}}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,a.jsx)("span",{className:"font-medium",children:l}),(0,a.jsxs)("span",{className:"text-gray-500",children:[d," 个任务 (",(d/e.length*100).toFixed(1),"%)"]})]}),(0,a.jsx)("div",{className:"w-full bg-gray-100 rounded-full h-1.5",children:(0,a.jsx)("div",{className:"h-1.5 rounded-full transition-all duration-500",style:{width:"".concat(d/e.length*100,"%"),backgroundColor:v.datasets[0].backgroundColor[t]}})})]})]},l)})})})]})]})]})]}):(0,a.jsx)(h,{tasks:e})]})}},7175:(e,s,t)=>{t.d(s,{LocaleProvider:()=>i,Y:()=>o});var a=t(5155),l=t(2115);let d={zh:{today:"今天",newTask:"新建任务",editTask:"编辑任务",taskTitle:"任务标题",tags:"标签",addTag:"添加标签",tagName:"标签名称",tagColor:"标签颜色",cancel:"取消",create:"创建",list:"列表",board:"看板",timeline:"时间线",calendar:"日历",mySpace:"我的空间",general:"常规",todo:"待办事项",inbox:"收件箱",trash:"回收站",taskProgress:"任务进度",debug:"调试",coding:"编码",design:"设计"},en:{today:"Today",newTask:"New Task",editTask:"Edit Task",taskTitle:"Task Title",tags:"Tags",addTag:"Add Tag",tagName:"Tag Name",tagColor:"Tag Color",cancel:"Cancel",create:"Create",list:"List",board:"Board",timeline:"Timeline",calendar:"Calendar",mySpace:"My Space",general:"General",todo:"Todo",inbox:"Inbox",trash:"Trash",taskProgress:"Task Progress",debug:"Debug",coding:"Coding",design:"Design"}},r=(0,l.createContext)(void 0);function i(e){let{children:s}=e,[t,i]=(0,l.useState)("zh");return(0,a.jsx)(r.Provider,{value:{locale:t,setLocale:i,t:e=>d[t][e]||e},children:s})}function o(){let e=(0,l.useContext)(r);if(void 0===e)throw Error("useLocale must be used within a LocaleProvider");return e}},5209:(e,s,t)=>{t.d(s,{TodoProvider:()=>m,k:()=>g});var a=t(5155),l=t(2115),d=t(1455),r=t.n(d);let i=[{id:"1",name:"开发",color:"bg-[#5252FF]"},{id:"2",name:"会议",color:"bg-[#FF7452]"},{id:"3",name:"休息",color:"bg-[#00C781]"}],o=[{id:"1",name:"调试",color:"bg-[#5252FF]",expanded:!0},{id:"2",name:"编码",color:"bg-[#FF7452]",expanded:!0},{id:"3",name:"设计",color:"bg-[#00C781]",expanded:!0}],n=(0,l.createContext)(void 0),c={TASKS:"todo-tasks",TAGS:"todo-tags",GROUPS:"todo-groups",SELECTED_GROUP:"todo-selected-group"};function m(e){let{children:s}=e,[t,d]=(0,l.useState)([]),[m,g]=(0,l.useState)([]),[x,h]=(0,l.useState)([]),[u,p]=(0,l.useState)("1");return(0,l.useEffect)(()=>{let e=localStorage.getItem(c.TASKS),s=localStorage.getItem(c.TAGS),t=localStorage.getItem(c.GROUPS),a=localStorage.getItem(c.SELECTED_GROUP);e&&d(JSON.parse(e)),s?g(JSON.parse(s)):g(i),t?h(JSON.parse(t)):h(o),a&&p(a)},[]),(0,l.useEffect)(()=>{localStorage.setItem(c.TASKS,JSON.stringify(t))},[t]),(0,l.useEffect)(()=>{localStorage.setItem(c.TAGS,JSON.stringify(m))},[m]),(0,l.useEffect)(()=>{localStorage.setItem(c.GROUPS,JSON.stringify(x))},[x]),(0,l.useEffect)(()=>{localStorage.setItem(c.SELECTED_GROUP,u)},[u]),(0,a.jsx)(n.Provider,{value:{tasks:t,tags:m,groups:x,selectedGroupId:u,addTask:e=>{d(s=>[...s,e]);let s=[...t,e];localStorage.setItem("todo-tasks",JSON.stringify(s))},toggleTask:e=>{d(s=>s.map(s=>s.id===e?{...s,completed:!s.completed}:s))},deleteTask:e=>{d(s=>s.filter(s=>s.id!==e))},addTag:(e,s)=>{let t={id:Math.random().toString(36).substr(2,9),name:e,color:s};g(e=>[...e,t])},deleteTag:e=>{if(t.some(s=>s.tag.id===e)){alert("该标签下还有任务，无法删除");return}g(s=>s.filter(s=>s.id!==e))},addGroup:(e,s)=>{let t={id:Math.random().toString(36).substr(2,9),name:e,color:s,expanded:!0};h(e=>[...e,t])},deleteGroup:e=>{if(t.some(s=>s.groupId===e)){alert("该分组下还有任务，无法删除");return}h(s=>s.filter(s=>s.id!==e))},selectGroup:e=>{p(e)},toggleGroupExpanded:e=>{h(s=>s.map(s=>s.id===e?{...s,expanded:!s.expanded}:s))},getGroupProgress:e=>{let s=t.filter(s=>s.groupId===e);return 0===s.length?0:Math.round(s.filter(e=>e.completed).length/s.length*100)},updateTask:e=>{d(s=>s.map(s=>s.id===e.id?e:s));let s=t.map(s=>s.id===e.id?e:s);localStorage.setItem("todo-tasks",JSON.stringify(s))},updateTaskTime:(e,s)=>{try{let t=r()(s);if(!t.isValid())throw Error("Invalid date format");console.log("Updating task time:",{taskId:e,date:s,parsedDate:t.format("YYYY-MM-DD HH:mm:ss")}),d(s=>{let a=s.map(s=>s.id===e?{...s,date:t.format("YYYY-MM-DD HH:mm:ss")}:s);if(!a.every(e=>r()(e.date).isValid()))throw Error("Invalid task dates detected");return localStorage.setItem("todo-tasks",JSON.stringify(a)),a})}catch(e){console.error("Error updating task time:",e)}}},children:s})}function g(){let e=(0,l.useContext)(n);if(void 0===e)throw Error("useTodo must be used within a TodoProvider");return e}}}]);