(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1330:(e,s,t)=>{Promise.resolve().then(t.bind(t,1110))},1110:(e,s,t)=>{"use strict";t.d(s,{default:()=>P});var a=t(5155),l=t(2115),r=t(6889),n=t(6764),c=t(9253),i=t(5209),d=t(8735),o=t(767),x=t(3473),m=t(7175);let h=e=>{var s;let{open:t,onOpenChange:r,initialGroupId:n=null,mode:c="create",task:h}=e,[g,u]=(0,l.useState)(""),{tags:p,groups:j,addTask:b,updateTask:N}=(0,i.k)(),{t:f}=(0,m.Y)(),[v,y]=(0,l.useState)(null),[w,k]=(0,l.useState)(n||(null===(s=j[0])||void 0===s?void 0:s.id)||""),[C,D]=(0,l.useState)(!1),[Y,S]=(0,l.useState)(""),[M,F]=(0,l.useState)("bg-[#5252FF]"),[A,I]=(0,l.useState)("30"),[H,T]=(0,l.useState)("1");return(0,l.useEffect)(()=>{"edit"===c&&h&&(u(h.title),y(h.tag),k(h.groupId),I(h.time.toString()),T(h.points.toString()))},[c,h]),(0,l.useEffect)(()=>{!v&&p.length>0&&y(p[0])},[p,v]),(0,l.useEffect)(()=>{n&&k(n)},[n]),(0,a.jsx)(d.bL,{open:t,onOpenChange:e=>{if(r(e),!e){var s;u(""),y(null),k(n||(null===(s=j[0])||void 0===s?void 0:s.id)||""),I("30"),T("1")}},children:(0,a.jsxs)(d.ZL,{children:[(0,a.jsx)(d.hJ,{className:"fixed inset-0 bg-black/50"}),(0,a.jsxs)(d.UC,{className:"fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white rounded-lg p-6 w-[400px]",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)(d.hE,{className:"text-lg font-semibold",children:f("edit"===c?"editTask":"newTask")}),(0,a.jsx)(d.bm,{className:"p-1 hover:bg-gray-100 rounded",children:(0,a.jsx)(o.A,{className:"w-5 h-5"})})]}),(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),g&&v&&w&&("edit"===c&&h?N({...h,title:g,tag:v,groupId:w,time:parseInt(A)||30,points:parseInt(H)||1}):b({id:Date.now().toString(),title:g,completed:!1,tag:v,groupId:w,date:new Date().toISOString(),time:parseInt(A)||30,points:parseInt(H)||1}),u(""),I("30"),T("1"),r(!1))},children:[(0,a.jsx)("input",{type:"text",value:g,onChange:e=>u(e.target.value),placeholder:f("taskTitle"),className:"w-full px-3 py-2 border rounded-lg mb-4",autoFocus:!0}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:f("tags")}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[p.map(e=>(0,a.jsx)("button",{type:"button",onClick:()=>y(e),className:"px-3 py-1 rounded-full text-sm ".concat((null==v?void 0:v.id)===e.id?"".concat(e.color," text-white"):"bg-gray-100"),children:e.name},e.id)),(0,a.jsxs)("button",{type:"button",onClick:()=>D(!0),className:"px-3 py-1 rounded-full text-sm bg-gray-100 hover:bg-gray-200 flex items-center gap-1",children:[(0,a.jsx)(x.A,{className:"w-4 h-4"}),f("addTag")]})]})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"分组"}),(0,a.jsx)("select",{value:w,onChange:e=>k(e.target.value),className:"w-full px-3 py-2 border rounded-lg",children:j.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"预计时间（分钟）"}),(0,a.jsx)("input",{type:"number",value:A,onChange:e=>I(e.target.value),min:"1",className:"w-full px-3 py-2 border rounded-lg"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"任务积分"}),(0,a.jsx)("input",{type:"number",value:H,onChange:e=>T(e.target.value),min:"1",className:"w-full px-3 py-2 border rounded-lg"})]})]}),C&&(0,a.jsxs)("div",{className:"mb-4 p-4 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:f("tagName")}),(0,a.jsx)("input",{type:"text",value:Y,onChange:e=>S(e.target.value),className:"w-full px-3 py-2 border rounded-lg"})]}),(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:f("tagColor")}),(0,a.jsx)("div",{className:"flex gap-2",children:["bg-[#5252FF]","bg-[#FF7452]","bg-[#00C781]","bg-[#FFCA58]","bg-[#FF4F56]","bg-[#7B61FF]","bg-[#00739D]","bg-[#00873D]"].map(e=>(0,a.jsx)("button",{type:"button",onClick:()=>F(e),className:"w-6 h-6 rounded-full ".concat(e," ").concat(M===e?"ring-2 ring-offset-2 ring-blue-500":"")},e))})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)("button",{type:"button",onClick:()=>D(!1),className:"px-3 py-1 text-sm text-gray-600 hover:bg-gray-200 rounded",children:f("cancel")}),(0,a.jsx)("button",{type:"button",onClick:()=>{Y.trim()&&(addTag(Y,M),S(""),D(!1))},className:"px-3 py-1 text-sm bg-[#5252FF] text-white rounded",children:f("create")})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)("button",{type:"button",onClick:()=>r(!1),className:"px-4 py-2 text-sm text-gray-600 hover:bg-gray-100 rounded-lg",children:f("cancel")}),(0,a.jsx)("button",{type:"submit",className:"px-4 py-2 text-sm bg-[#5252FF] text-white rounded-lg",disabled:!g.trim()||!v,children:f("edit"===c?"save":"create")})]})]})]})]})})};var g=t(2423),u=t(853),p=t(8236),j=t(3950),b=t(1719),N=t(6967),f=t(1455),v=t.n(f),y=t(3518);let w=e=>{let{currentDate:s,tasks:t,onDayClick:l}=e,r=e=>t.filter(s=>v()(s.date).isSame(e,"day")),n=(()=>{let e=s.startOf("month"),t=s.endOf("month"),a=e.startOf("week"),l=t.endOf("week"),r=[],n=a;for(;n.isBefore(l)||n.isSame(l,"day");)r.push(n),n=n.add(1,"day");return r})();return(0,a.jsxs)("div",{className:"h-full flex flex-col",children:[(0,a.jsx)("div",{className:"grid grid-cols-7 mb-2",children:["日","一","二","三","四","五","六"].map((e,s)=>(0,a.jsx)("div",{className:"text-center py-2 text-sm font-medium\n              ".concat(0===s||6===s?"text-red-500":"text-gray-600"),children:e},e))}),(0,a.jsx)("div",{className:"flex-1 grid grid-cols-7 gap-1",children:n.map(e=>{let t=e.isSame(v()(),"day"),n=e.isSame(s,"month"),c=r(e);return(0,a.jsxs)("div",{onClick:()=>l(e),className:"\n                min-h-[100px] p-1 border rounded\n                ".concat(n?"bg-white":"bg-gray-50","\n                ").concat(t?"border-blue-500":"border-gray-200","\n                hover:border-blue-500 cursor-pointer\n              "),children:[(0,a.jsx)("div",{className:"\n                text-right text-sm mb-1\n                ".concat(n?"text-gray-900":"text-gray-400","\n                ").concat(t?"font-bold":"","\n              "),children:e.format("D")}),(0,a.jsxs)("div",{className:"space-y-1",children:[c.slice(0,3).map(e=>(0,a.jsx)("div",{className:"text-xs px-1 py-0.5 rounded bg-blue-50 text-blue-600 truncate",children:e.title},e.id)),c.length>3&&(0,a.jsxs)("div",{className:"text-xs text-gray-500 px-1",children:["+",c.length-3," 更多"]})]})]},e.format("YYYY-MM-DD"))})})]})};var k=t(4055);let C=e=>{let{currentDate:s,tasks:t,onTaskClick:l,onTaskMove:r}=e,n=(e,s)=>t.filter(t=>{if(!t.date)return!1;let a=v()(t.date);return a.format("YYYY-MM-DD")===e.format("YYYY-MM-DD")&&a.hour()===s}),c=(()=>{let e=[],t=s.startOf("week");for(let s=0;s<7;s++)e.push(t),t=t.add(1,"day");return e})(),i=(()=>{let e=[];for(let s=0;s<24;s++)e.push(s);return e})();return(0,a.jsx)(k.JY,{onDragEnd:e=>{if(!e.destination||!r)return;let{draggableId:t,destination:a}=e,l=a.droppableId.lastIndexOf("-"),n=a.droppableId.substring(0,l),c=a.droppableId.substring(l+1);console.log("Drop info:",{currentDate:s.format("YYYY-MM-DD"),droppableId:a.droppableId,dateStr:n,hourStr:c,parsedDate:v()(n).format("YYYY-MM-DD")}),r(t,n,parseInt(c))},children:(0,a.jsxs)("div",{className:"h-full flex flex-col",children:[(0,a.jsxs)("div",{className:"grid grid-cols-8 border-b",children:[(0,a.jsx)("div",{className:"p-4 border-r text-gray-500 text-sm",children:"时间"}),c.map((e,s)=>(0,a.jsxs)("div",{className:"p-4 border-r text-center ".concat(e.isSame(v()(),"day")?"bg-blue-50":""),children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:["周日","周一","周二","周三","周四","周五","周六"][s]}),(0,a.jsx)("div",{className:"text-lg font-medium ".concat(e.isSame(v()(),"day")?"text-blue-600":""),children:e.format("DD")})]},e.format("YYYY-MM-DD")))]}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto",children:(0,a.jsxs)("div",{className:"grid grid-cols-8",children:[(0,a.jsx)("div",{className:"border-r",children:i.map(e=>(0,a.jsx)("div",{className:"h-20 border-b p-2 text-sm text-gray-500",children:"".concat(e.toString().padStart(2,"0"),":00")},e))}),c.map(e=>(0,a.jsx)("div",{className:"border-r",children:i.map(s=>{let t=n(e,s);return(0,a.jsx)(k.gL,{droppableId:"".concat(e.format("YYYY-MM-DD"),"-").concat(s),children:(e,s)=>(0,a.jsxs)("div",{ref:e.innerRef,...e.droppableProps,className:"h-20 border-b p-1 relative group ".concat(s.isDraggingOver?"bg-blue-50":""),children:[(0,a.jsx)("div",{className:"absolute inset-x-1 top-1 space-y-1 max-h-[72px] overflow-y-auto",children:t.map((e,s)=>(0,a.jsx)(k.sx,{draggableId:e.id,index:s,children:(s,t)=>(0,a.jsxs)("div",{ref:s.innerRef,...s.draggableProps,...s.dragHandleProps,onClick:s=>{s.preventDefault(),s.stopPropagation(),null==l||l(e)},className:"\n                                      text-xs p-1 rounded cursor-move\n                                      ".concat(e.tag.color.replace("bg-","")," bg-opacity-10\n                                      hover:bg-opacity-20 \n                                      flex items-center gap-1\n                                      ").concat(t.isDragging?"shadow-lg ring-2 ring-blue-500":"","\n                                      transition-all duration-200\n                                      select-none\n                                    "),children:[(0,a.jsx)("div",{className:"w-1.5 h-1.5 rounded-full flex-shrink-0 ".concat(e.tag.color)}),(0,a.jsx)("span",{className:"truncate flex-1",children:e.title}),(0,a.jsxs)("span",{className:"text-[10px] text-gray-500 flex-shrink-0",children:[e.time,"分"]})]})},e.id))}),e.placeholder,0===t.length&&(0,a.jsx)("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 bg-blue-50/20 transition-opacity"})]})},"".concat(e.format("YYYY-MM-DD"),"-").concat(s))})},e.format("YYYY-MM-DD")))]})})]})})},D=e=>{let{currentDate:s,tasks:t,onTaskClick:l}=e,r=e=>t.filter(t=>{let a=v()(t.date);return a.isSame(s,"day")&&a.hour()===e}),n=(()=>{let e=[];for(let s=0;s<24;s++)e.push(s);return e})(),c=t.filter(e=>v()(e.date).isSame(s,"day"));return(0,a.jsxs)("div",{className:"h-full grid grid-cols-4 gap-4",children:[(0,a.jsx)("div",{className:"col-span-3 overflow-y-auto",children:(0,a.jsx)("div",{className:"grid grid-cols-1",children:n.map(e=>{let s=r(e);return(0,a.jsxs)("div",{className:"relative h-20 border-b group hover:bg-gray-50",children:[(0,a.jsx)("div",{className:"absolute -left-16 top-0 w-16 pr-4 text-right text-sm text-gray-500",children:"".concat(e.toString().padStart(2,"0"),":00")}),(0,a.jsx)("div",{className:"pl-4 py-1 space-y-1",children:s.map(e=>(0,a.jsxs)("div",{onClick:()=>null==l?void 0:l(e),className:"\n                        flex items-center gap-2 p-2 rounded cursor-pointer\n                        ".concat(e.tag.color.replace("bg-","")," bg-opacity-10\n                        hover:bg-opacity-20\n                      "),children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(e.tag.color)}),(0,a.jsx)("span",{className:"flex-1 text-sm truncate",children:e.title}),(0,a.jsxs)("span",{className:"text-xs text-gray-500",children:[e.time,"分钟"]})]},e.id))})]},e)})})}),(0,a.jsxs)("div",{className:"border-l p-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium mb-4",children:"今日任务"}),(0,a.jsx)("div",{className:"space-y-2",children:c.map(e=>(0,a.jsxs)("div",{onClick:()=>null==l?void 0:l(e),className:"\n                p-3 rounded-lg cursor-pointer\n                ".concat(e.tag.color.replace("bg-","")," bg-opacity-10\n                hover:bg-opacity-20\n              "),children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(e.tag.color)}),(0,a.jsx)("span",{className:"text-sm font-medium",children:e.title})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[(0,a.jsx)("span",{children:v()(e.date).format("HH:mm")}),(0,a.jsxs)("span",{children:[e.time,"分钟"]})]})]},e.id))})]})]})},Y=()=>{let[e,s]=(0,l.useState)(v()()),[t,r]=(0,l.useState)("month"),{tasks:n,updateTaskTime:c}=(0,i.k)();return(0,a.jsxs)("div",{className:"h-full flex flex-col bg-white rounded-xl shadow-sm",children:[(0,a.jsxs)("div",{className:"p-4 border-b flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("h1",{className:"text-xl font-semibold",children:e.format("YYYY年 MM月")}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:()=>{switch(t){case"month":s(e=>e.subtract(1,"month"));break;case"week":s(e=>e.subtract(1,"week"));break;case"day":s(e=>e.subtract(1,"day"))}},className:"p-1 hover:bg-gray-100 rounded",children:(0,a.jsx)(y.A,{className:"w-5 h-5"})}),(0,a.jsx)("button",{onClick:()=>{switch(t){case"month":s(e=>e.add(1,"month"));break;case"week":s(e=>e.add(1,"week"));break;case"day":s(e=>e.add(1,"day"))}},className:"p-1 hover:bg-gray-100 rounded",children:(0,a.jsx)(N.A,{className:"w-5 h-5"})}),(0,a.jsx)("button",{onClick:()=>s(v()()),className:"px-3 py-1 text-sm bg-gray-100 hover:bg-gray-200 rounded",children:"今天"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:()=>r("month"),className:"px-3 py-1 text-sm rounded ".concat("month"===t?"bg-blue-100 text-blue-600":"hover:bg-gray-100"),children:"月"}),(0,a.jsx)("button",{onClick:()=>r("week"),className:"px-3 py-1 text-sm rounded ".concat("week"===t?"bg-blue-100 text-blue-600":"hover:bg-gray-100"),children:"周"}),(0,a.jsx)("button",{onClick:()=>r("day"),className:"px-3 py-1 text-sm rounded ".concat("day"===t?"bg-blue-100 text-blue-600":"hover:bg-gray-100"),children:"日"})]})]}),(0,a.jsxs)("div",{className:"flex-1 p-4",children:["month"===t&&(0,a.jsx)(w,{currentDate:e,tasks:n,onDayClick:e=>{s(e),r("day")}}),"week"===t&&(0,a.jsx)(C,{currentDate:e,tasks:n,onTaskClick:e=>{console.log("Task clicked:",e)},onTaskMove:(e,s,t)=>{try{let a=v()(s);if(!a.isValid()){console.error("Invalid date:",s);return}let l=a.hour(t).minute(0).second(0);console.log("Moving task",{taskId:e,originalDate:s,parsedDate:a.format("YYYY-MM-DD"),targetHour:t,finalDate:l.format("YYYY-MM-DD HH:mm:ss")}),c(e,l.format("YYYY-MM-DD HH:mm:ss"))}catch(e){console.error("Error moving task:",e)}}}),"day"===t&&(0,a.jsx)(D,{currentDate:e,tasks:n,onTaskClick:e=>{console.log("Task clicked:",e)}})]})]})};var S=t(1355);let M=()=>{let{tasks:e,groups:s,tags:t,toggleTask:n}=(0,i.k)(),[c,d]=l.useState(""),[m,f]=(0,l.useState)(!1),[y,w]=(0,l.useState)(!1),[k,C]=l.useState(!1),[D,M]=l.useState(!1),[F,A]=l.useState(()=>{let e=localStorage.getItem("todoDisplaySettings");return e?JSON.parse(e):{showCompleted:!0,showTime:!0,showPoints:!0,sortBy:"date"}}),[I,H]=l.useState(F),T={total:e.length,completed:e.filter(e=>e.completed).length,upcoming:e.filter(e=>!e.completed&&new Date(e.date)>new Date).length,today:e.filter(e=>v()(e.date).isSame(v()(),"day")).length},O=T.total>0?Math.round(T.completed/T.total*100):0,E=s.map(s=>({...s,tasks:e.filter(e=>e.groupId===s.id)})),P=e=>{if(!c)return e;let t=c.toLowerCase();return e.filter(e=>{var a;return e.title.toLowerCase().includes(t)||e.tag.name.toLowerCase().includes(t)||(null===(a=s.find(s=>s.id===e.groupId))||void 0===a?void 0:a.name.toLowerCase().includes(t))})},z=e=>{J(s=>({...s,[e]:!s[e]}))};l.useEffect(()=>{localStorage.setItem("todoDisplaySettings",JSON.stringify(F))},[F]);let B=e=>{H(s=>({...s,[e]:!s[e]}))},L=e=>{let s=[...e];return F.showCompleted||(s=s.filter(e=>!e.completed)),s.sort((e,s)=>{switch(F.sortBy){case"date":return new Date(s.date).getTime()-new Date(e.date).getTime();case"priority":return(s.tag.priority||0)-(e.tag.priority||0);case"points":return(s.points||0)-(e.points||0);default:return 0}}),s},[_,J]=l.useState(()=>s.reduce((e,s)=>({...e,[s.id]:!0}),{}));return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"grid grid-cols-12 gap-6 p-6",children:[(0,a.jsxs)("div",{className:"col-span-3 space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6 space-y-4",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold",children:"任务概览"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"bg-blue-50 rounded-lg p-4",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:T.today}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"今日任务"})]}),(0,a.jsxs)("div",{className:"bg-green-50 rounded-lg p-4",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-green-600",children:T.completed}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"已完成"})]}),(0,a.jsxs)("div",{className:"bg-yellow-50 rounded-lg p-4",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-yellow-600",children:T.upcoming}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"即将到期"})]}),(0,a.jsxs)("div",{className:"bg-purple-50 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"text-2xl font-bold text-purple-600",children:[O,"%"]}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"完成率"})]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6 space-y-4",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold",children:"快捷操作"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("button",{className:"w-full flex items-center gap-2 px-4 py-2 text-sm bg-[#5252FF] text-white rounded-lg hover:bg-blue-600",onClick:()=>C(!0),children:[(0,a.jsx)(x.A,{className:"w-4 h-4"}),"新建任务"]}),(0,a.jsxs)("button",{className:"w-full flex items-center gap-2 px-4 py-2 text-sm border border-gray-200 rounded-lg hover:bg-gray-50",onClick:()=>M(!0),children:[(0,a.jsx)(g.A,{className:"w-4 h-4"}),"查看日历"]})]})]})]}),(0,a.jsxs)("div",{className:"col-span-6 space-y-6",children:[(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsxs)("div",{className:"flex-1 relative",children:[(0,a.jsx)(u.A,{className:"w-5 h-5 text-gray-400 absolute left-3 top-1/2 transform -translate-y-1/2"}),(0,a.jsx)("input",{type:"text",value:c,onChange:e=>{d(e.target.value),e.target.value&&J(s.reduce((e,s)=>({...e,[s.id]:!0}),{}))},placeholder:"搜索任务...",className:"w-full pl-10 pr-10 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),c&&(0,a.jsx)("button",{onClick:()=>{d("")},className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:(0,a.jsx)(o.A,{className:"w-5 h-5"})})]}),(0,a.jsx)("button",{onClick:()=>{H(F),f(!0)},className:"p-2 hover:bg-gray-100 rounded-lg",title:"设置",children:(0,a.jsx)(p.A,{className:"w-5 h-5"})}),(0,a.jsx)("button",{onClick:()=>w(!0),className:"p-2 hover:bg-gray-100 rounded-lg",title:"数据分析",children:(0,a.jsx)(j.A,{className:"w-5 h-5"})})]}),(0,a.jsx)("div",{className:"space-y-6",children:E.map(e=>{let s=L(P(e.tasks));return c&&0===s.length?null:(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 cursor-pointer",onClick:()=>z(e.id),children:[_[e.id]?(0,a.jsx)(b.A,{className:"w-5 h-5 text-gray-400"}):(0,a.jsx)(N.A,{className:"w-5 h-5 text-gray-400"}),(0,a.jsx)("h3",{className:"text-lg font-semibold",children:e.name})]}),(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:[s.length," 个任务"]})]}),_[e.id]&&(0,a.jsx)("div",{className:"space-y-3",children:s.map(e=>(0,a.jsxs)("div",{className:"flex items-center gap-4 p-4 bg-gray-50 rounded-lg hover:bg-gray-100",children:[(0,a.jsx)("input",{type:"checkbox",checked:e.completed,onChange:()=>n(e.id),className:"w-4 h-4 rounded border-gray-300"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:e.completed?"line-through text-gray-400":"",children:e.title}),(0,a.jsx)("span",{className:"px-2 py-0.5 text-xs text-white rounded-full ".concat(e.tag.color),children:e.tag.name})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-1 text-sm text-gray-500",children:[F.showTime&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.A,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:v()(e.date).format("MM-DD HH:mm")}),(0,a.jsx)("span",{children:"\xb7"}),(0,a.jsxs)("span",{children:[e.time,"分钟"]})]}),F.showPoints&&(0,a.jsxs)(a.Fragment,{children:[F.showTime&&(0,a.jsx)("span",{children:"\xb7"}),(0,a.jsxs)("span",{children:[e.points,"积分"]})]})]})]})]},e.id))})]},e.id)})})]}),(0,a.jsxs)("div",{className:"col-span-3 space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"标签统计"}),(0,a.jsx)("div",{className:"space-y-3",children:t.map(s=>{let t=e.filter(e=>e.tag.id===s.id),l=t.filter(e=>e.completed),r=t.length>0?Math.round(l.length/t.length*100):0;return(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(s.color)}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{children:s.name}),(0,a.jsxs)("span",{className:"text-gray-500",children:[r,"%"]})]}),(0,a.jsx)("div",{className:"mt-1 h-1.5 bg-gray-100 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full ".concat(s.color),style:{width:"".concat(r,"%")}})})]})]},s.id)})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"待办事项"}),(0,a.jsx)("div",{className:"space-y-3",children:e.filter(e=>!e.completed).slice(0,5).map(e=>(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(e.tag.color)}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"text-sm",children:e.title}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:v()(e.date).format("MM-DD HH:mm")})]})]},e.id))})]})]})]}),m&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsx)("div",{className:"bg-white rounded-xl w-[480px] max-h-[80vh] overflow-y-auto",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"设置"}),(0,a.jsx)("button",{onClick:()=>f(!1),className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)(o.A,{className:"w-6 h-6"})})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-medium mb-3",children:"显示选项"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("label",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"checkbox",className:"rounded",checked:I.showCompleted,onChange:()=>B("showCompleted")}),(0,a.jsx)("span",{children:"显示已完成任务"})]}),(0,a.jsxs)("label",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"checkbox",className:"rounded",checked:I.showTime,onChange:()=>B("showTime")}),(0,a.jsx)("span",{children:"显示任务时间"})]}),(0,a.jsxs)("label",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"checkbox",className:"rounded",checked:I.showPoints,onChange:()=>B("showPoints")}),(0,a.jsx)("span",{children:"显示任务积分"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-medium mb-3",children:"排序方式"}),(0,a.jsxs)("select",{className:"w-full p-2 border rounded-lg",value:I.sortBy,onChange:e=>{H(s=>({...s,sortBy:e.target.value}))},children:[(0,a.jsx)("option",{value:"date",children:"按日期"}),(0,a.jsx)("option",{value:"priority",children:"按优先级"}),(0,a.jsx)("option",{value:"points",children:"按积分"})]})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-3 mt-6",children:[(0,a.jsx)("button",{onClick:()=>{H(F),f(!1)},className:"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg",children:"取消"}),(0,a.jsx)("button",{onClick:()=>{A(I),localStorage.setItem("todoDisplaySettings",JSON.stringify(I)),f(!1)},className:"px-4 py-2 bg-[#5252FF] text-white rounded-lg hover:bg-blue-600",children:"保存"})]})]})})}),y&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl w-[90vw] max-w-[1200px] max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border-b bg-white z-10",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"数据分析"}),(0,a.jsx)("button",{onClick:()=>w(!1),className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)(o.A,{className:"w-6 h-6"})})]}),(0,a.jsx)(S.A,{})]})}),D&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-6 overflow-hidden",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl w-full max-w-[1200px] h-[90vh] flex flex-col",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"日历视图"}),(0,a.jsx)("button",{onClick:()=>M(!1),className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)(o.A,{className:"w-6 h-6"})})]}),(0,a.jsx)("div",{className:"flex-1 p-4 overflow-auto",children:(0,a.jsx)(Y,{})})]})}),(0,a.jsx)(h,{open:k,onOpenChange:C})]})};var F=t(1290),A=t(1902),I=t(3230),H=t(775);t(4693),v().locale("zh-cn");let T=e=>{let{task:s,group:t,layout:l,isCompact:r}=e;return(0,a.jsxs)("div",{className:"relative flex items-start gap-4 ".concat("alternating"===l?"even:flex-row-reverse":""),children:[(0,a.jsxs)("div",{className:"flex flex-col items-center min-w-[120px]",children:[(0,a.jsx)("div",{className:"text-sm text-gray-500 mb-2",children:(e=>{if(!e)return v()().format("YYYY年MM月DD日 HH:mm");try{return v()(e).format("YYYY年MM月DD日 HH:mm")}catch(e){return v()().format("YYYY年MM月DD日 HH:mm")}})(s.date)}),(0,a.jsx)("div",{className:"w-3 h-3 rounded-full bg-[#5252FF] relative",children:s.completed&&(0,a.jsx)("div",{className:"absolute -top-1 -right-1 w-2 h-2 bg-green-500 rounded-full"})}),(0,a.jsx)("div",{className:"w-0.5 h-full bg-gray-200 absolute top-10"})]}),(0,a.jsxs)("div",{className:"flex-1 bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow p-4 mb-6 ".concat(r?"py-3":"py-4"),children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900",children:s.title}),(0,a.jsxs)("div",{className:"mt-1 flex items-center gap-2 text-sm",children:[(0,a.jsx)("span",{className:"px-2 py-0.5 rounded-full text-white text-xs ".concat(s.tag.color),children:s.tag.name}),(0,a.jsx)("span",{className:"text-gray-500",children:"\xb7"}),(0,a.jsx)("span",{className:"text-gray-500",children:null==t?void 0:t.name})]})]}),(0,a.jsx)("span",{className:"text-sm ".concat(s.completed?"text-green-500":"text-blue-500"),children:s.completed?"已完成":"进行中"})]}),!r&&s&&(0,a.jsx)("div",{className:"mt-3 text-sm text-gray-600",children:(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("span",{children:["预计时间: ",s.time,"分钟"]}),(0,a.jsxs)("span",{children:["积分: ",s.points]})]})})]})]})},O=e=>{let{tasks:s,groups:t,layout:l="vertical",isCompact:r=!1}=e,n=[...s].sort((e,s)=>{let t=e.date?v()(e.date).unix():0;return(s.date?v()(s.date).unix():0)-t});return(0,a.jsx)("div",{className:"relative px-4",children:n.map(e=>(0,a.jsx)(T,{task:e,group:t.find(s=>s.id===e.groupId),layout:l,isCompact:r},e.id))})},E=()=>{let{tasks:e,groups:s}=(0,i.k)(),[t,r]=(0,l.useState)("all"),[n,c]=(0,l.useState)("comfortable"),[d,o]=(0,l.useState)("vertical"),[x,m]=(0,l.useState)(!1),[h,g]=(0,l.useState)(!1),u=(0,l.useMemo)(()=>{let s=[...e].sort((e,s)=>{let t=new Date(e.date||Date.now());return new Date(s.date||Date.now()).getTime()-t.getTime()});return"all"===t?s:s.filter(e=>e.groupId===t)},[e,t]);return(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"mb-6 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("button",{onClick:()=>r("all"),className:"px-4 py-2 rounded-full text-sm ".concat("all"===t?"bg-[rgba(82,82,255,0.1)] text-[#5252FF]":"text-gray-600 hover:bg-gray-100"),children:"全部任务"}),s.map(e=>(0,a.jsx)("button",{onClick:()=>r(e.id),className:"px-4 py-2 rounded-full text-sm ".concat(t===e.id?"bg-[rgba(82,82,255,0.1)] text-[#5252FF]":"text-gray-600 hover:bg-gray-100"),children:e.name},e.id))]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{onClick:()=>g(!h),className:"flex items-center px-4 py-2 text-sm text-gray-600 hover:bg-gray-100 rounded-lg",children:[(0,a.jsx)(F.A,{className:"w-4 h-4 mr-2"}),"vertical"===d?"垂直布局":"交错布局",h?(0,a.jsx)(A.A,{className:"w-4 h-4 ml-2"}):(0,a.jsx)(b.A,{className:"w-4 h-4 ml-2"})]}),h&&(0,a.jsxs)("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg py-2 z-10",children:[(0,a.jsxs)("button",{onClick:()=>{o("vertical"),g(!1)},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100",children:["垂直布局",(0,a.jsx)("span",{className:"text-xs text-gray-500 ml-2",children:"单列显示"})]}),(0,a.jsxs)("button",{onClick:()=>{o("alternating"),g(!1)},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100",children:["交错布局",(0,a.jsx)("span",{className:"text-xs text-gray-500 ml-2",children:"双列显示"})]})]})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{onClick:()=>m(!x),className:"flex items-center px-4 py-2 text-sm text-gray-600 hover:bg-gray-100 rounded-lg",children:["compact"===n?(0,a.jsx)(I.A,{className:"w-4 h-4 mr-2"}):(0,a.jsx)(H.A,{className:"w-4 h-4 mr-2"}),"compact"===n?"紧凑视图":"舒适视图",x?(0,a.jsx)(A.A,{className:"w-4 h-4 ml-2"}):(0,a.jsx)(b.A,{className:"w-4 h-4 ml-2"})]}),x&&(0,a.jsxs)("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg py-2 z-10",children:[(0,a.jsxs)("button",{onClick:()=>{c("comfortable"),m(!1)},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100",children:["舒适视图",(0,a.jsx)("span",{className:"text-xs text-gray-500 ml-2",children:"显示更多内容"})]}),(0,a.jsxs)("button",{onClick:()=>{c("compact"),m(!1)},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100",children:["紧凑视图",(0,a.jsx)("span",{className:"text-xs text-gray-500 ml-2",children:"显示更少内容"})]})]})]})]})]}),(0,a.jsx)("div",{className:"h-[calc(100vh-200px)] overflow-auto",children:u.length>0?(0,a.jsx)(O,{tasks:u,groups:s,layout:d,isCompact:"compact"===n}):(0,a.jsx)("div",{className:"flex items-center justify-center h-full text-gray-400",children:"暂无任务"})})]})},P=()=>{let[e,s]=(0,l.useState)(!1),[t,d]=(0,l.useState)(!1),[o,x]=(0,l.useState)(null),[m,g]=(0,l.useState)(null),[u,p]=(0,l.useState)("list"),{tasks:j,toggleTask:b,selectedGroupId:N,updateTask:f}=(0,i.k)(),y=(0,c.GP)(new Date,"dd MMMM"),w=N?j.filter(e=>e.groupId===N):j,k=e=>{x(e),d(!0),s(!0)},C=e=>{g(e.id)},D=e=>{m===e.id&&g(null)},Y=(e,s)=>{let t=e.target.value.trim();t!==s.title&&f({...s,title:t})};return(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("h1",{className:"text-xl font-semibold",children:["Today, ",y]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:()=>p("list"),className:"px-4 py-1 text-sm rounded-full ".concat("list"===u?"bg-[rgba(82,82,255,0.1)] text-[#5252FF]":"text-gray-600 hover:bg-gray-100"),children:"列表"}),(0,a.jsx)("button",{onClick:()=>p("board"),className:"px-4 py-1 text-sm rounded-full ".concat("board"===u?"bg-[rgba(82,82,255,0.1)] text-[#5252FF]":"text-gray-600 hover:bg-gray-100"),children:"面板"}),(0,a.jsx)("button",{onClick:()=>p("timeline"),className:"px-4 py-1 text-sm rounded-full ".concat("timeline"===u?"bg-[rgba(82,82,255,0.1)] text-[#5252FF]":"text-gray-600 hover:bg-gray-100"),children:"时间线"})]})]}),(0,a.jsx)("button",{onClick:()=>{d(!1),s(!0)},className:"px-4 py-2 bg-[#5252FF] text-white rounded-lg text-sm",children:"新任务"})]}),"list"===u&&(0,a.jsx)("div",{className:"space-y-2",children:w.map(e=>(0,a.jsxs)("div",{className:"flex items-center h-14 px-4 border rounded-lg hover:bg-gray-50",children:[(0,a.jsx)("input",{type:"checkbox",checked:e.completed,onChange:()=>b(e.id),className:"w-[18px] h-[18px] border-2 rounded cursor-pointer"}),m===e.id?(0,a.jsx)("input",{type:"text",className:"flex-1 px-3 py-2 border rounded-lg",value:e.title,onChange:s=>Y(s,e),onBlur:()=>D(e),onKeyDown:s=>"Enter"===s.key&&D(e),autoFocus:!0}):(0,a.jsx)("span",{className:"ml-3 flex-1 ".concat(e.completed?"line-through text-gray-400":""),onDoubleClick:()=>C(e),children:e.title}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("span",{className:"px-3 py-1 text-xs text-white rounded-full ".concat(e.tag.color),children:e.tag.name}),(0,a.jsx)("button",{onClick:()=>k(e),children:(0,a.jsx)(n.A,{className:"w-4 h-4"})}),(0,a.jsxs)("div",{className:"flex items-center text-gray-500",children:[(0,a.jsx)(r.A,{className:"w-4 h-4 mr-1"}),(0,a.jsx)("span",{className:"text-xs",children:e.time}),(0,a.jsx)("span",{className:"mx-1 text-xs",children:"\xb7"}),(0,a.jsx)("span",{className:"text-xs",children:e.points}),(0,a.jsx)("span",{className:"mx-1 text-xs",children:"\xb7"}),(0,a.jsx)("span",{className:"text-xs",children:v()(e.date).format("YYYY-MM-DD HH:mm")})]})]})]},e.id))}),"board"===u&&(0,a.jsx)(M,{}),"timeline"===u&&(0,a.jsx)(E,{}),"calendar"===u&&(0,a.jsx)("div",{className:"flex items-center justify-center h-[400px] text-gray-400",children:"日历视图开发中..."}),(0,a.jsx)(h,{initialGroupId:N,open:e,onOpenChange:s,mode:t?"edit":"create",task:o})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[647,309,850,2,317,441,517,358],()=>s(1330)),_N_E=e.O()}]);